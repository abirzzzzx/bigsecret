<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>User Manager — Minimal Console</title>

  <!-- Google Fonts -->
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;600;700&family=Plus+Jakarta+Sans:wght@400;600;700&display=swap" rel="stylesheet">

  <style>
    :root{
      --bg-900: #06070a;
      --bg-800: #0b0d11;
      --card: rgba(255,255,255,0.03);
      --muted: rgba(255,255,255,0.6);
      --glass: rgba(255,255,255,0.02);
      --accent: #6ee7ff;
      --accent-2: #8b5cf6;
      --success: #34d399;
      --danger: #ff6b6b;
      --suspend: #f6c85f;
      --glass-border: rgba(255,255,255,0.04);
      --radius: 12px;
    }

    *{box-sizing:border-box}
    html,body{height:100%}
    body{
      margin:0;
      font-family:"Plus Jakarta Sans",Inter,system-ui,-apple-system,"Segoe UI",Roboto,Arial;
      background: radial-gradient(900px 600px at 10% 10%, rgba(139,92,246,0.06), transparent 6%),
                  radial-gradient(900px 600px at 90% 90%, rgba(110,231,255,0.04), transparent 6%),
                  linear-gradient(180deg,var(--bg-900),var(--bg-800));
      color: #e8eefc;
      -webkit-font-smoothing:antialiased;
      display:flex;
      min-height:100vh;
      align-items:center;
      justify-content:center;
      padding:32px;
    }

    /* Container */
    .shell{
      width:100%;
      max-width:1100px;
      display:grid;
      grid-template-columns: 380px 1fr;
      gap:20px;
      align-items:start;
    }

    /* Left: control card */
    .card {
      background: linear-gradient(180deg, rgba(255,255,255,0.02), transparent);
      border:1px solid var(--glass-border);
      border-radius:var(--radius);
      padding:18px;
      box-shadow: 0 10px 30px rgba(2,6,23,0.6);
      backdrop-filter: blur(8px) saturate(120%);
    }

    .card h2{
      margin:0 0 8px 0;
      font-size:16px;
      letter-spacing:0.2px;
      font-weight:700;
    }
    .card p.lead{
      margin:0 0 14px 0;
      color:var(--muted);
      font-size:13px;
    }

    .command-row{
      display:flex;
      gap:10px;
      align-items:center;
    }

    .cmd-input{
      flex:1;
      display:flex;
      background:var(--glass);
      border-radius:10px;
      padding:8px;
      border:1px solid rgba(255,255,255,0.02);
      align-items:center;
      gap:8px;
    }
    .cmd-input input{
      background:transparent;
      border:0;
      outline:none;
      color:inherit;
      font-size:14px;
      padding:8px;
      width:100%;
    }

    .btn {
      background: linear-gradient(90deg,var(--accent),var(--accent-2));
      color:#071021;
      border:none;
      padding:10px 12px;
      border-radius:10px;
      cursor:pointer;
      font-weight:700;
      box-shadow:0 8px 24px rgba(124,92,255,0.08);
      transition:transform .16s ease, box-shadow .16s ease;
    }
    .btn:hover{ transform: translateY(-3px) }

    .hint {
      margin-top:12px;
      font-size:13px;
      color:var(--muted);
      background: linear-gradient(180deg, rgba(255,255,255,0.015), transparent);
      padding:10px;
      border-radius:10px;
      border:1px solid rgba(255,255,255,0.02);
    }

    .chips{
      display:flex;
      gap:8px;
      margin-top:10px;
      flex-wrap:wrap;
    }
    .chip{
      padding:8px 10px;
      border-radius:999px;
      background:transparent;
      border:1px solid rgba(255,255,255,0.03);
      color:var(--muted);
      font-size:13px;
      cursor:pointer;
    }
    .chip:hover{ background:rgba(255,255,255,0.02); transform:translateY(-3px) }

    .log {
      margin-top:12px;
      background:rgba(3,6,12,0.6);
      border-radius:10px;
      padding:12px;
      height:260px;
      overflow:auto;
      color:var(--muted);
      font-family: ui-monospace, SFMono-Regular, Menlo, Monaco, "Roboto Mono", monospace;
      font-size:13px;
      border:1px solid rgba(255,255,255,0.02);
    }
    .log .entry{
      padding:8px 0;
      border-bottom:1px dashed rgba(255,255,255,0.02);
      display:flex;
      gap:8px;
      align-items:flex-start;
    }
    .log .entry .ts{
      color:#9fb0ff;
      min-width:72px;
      font-size:12px;
    }
    .log .entry.error { color: var(--danger) }
    .log .entry.info { color: var(--muted) }

    /* Right: users list */
    .panel {
      background: linear-gradient(180deg, rgba(255,255,255,0.02), transparent);
      border:1px solid var(--glass-border);
      border-radius:var(--radius);
      padding:16px;
      box-shadow: 0 10px 30px rgba(2,6,23,0.6);
    }
    .panel h3{ margin:0 0 8px 0; font-size:15px }
    .panel p{ margin:0 0 12px 0; color:var(--muted); font-size:13px }

    .users {
      display:grid;
      gap:10px;
      max-height:72vh;
      overflow:auto;
    }

    .user {
      display:flex;
      gap:12px;
      align-items:center;
      padding:10px;
      border-radius:10px;
      background: linear-gradient(180deg, rgba(255,255,255,0.01), transparent);
      border:1px solid rgba(255,255,255,0.02);
    }
    .user:hover{ transform: translateY(-3px); }
    .u-avatar{
      width:52px;height:52px;border-radius:10px;background:linear-gradient(135deg,var(--accent-2),var(--accent));
      color:#071021; display:flex;align-items:center;justify-content:center;font-weight:700;font-family: "Plus Jakarta Sans";
      flex-shrink:0;
    }
    .u-body { flex:1; min-width:0 }
    .u-name { font-weight:700; font-size:15px; display:flex; gap:8px; align-items:center; flex-wrap:wrap }
    .u-id { font-size:12px; color:var(--muted); font-weight:600 }
    .u-sub { font-size:13px; color:var(--muted); margin-top:4px }

    .u-meta { display:flex; gap:8px; align-items:center }
    .pill {
      padding:6px 9px;
      border-radius:999px;
      font-weight:700;
      font-size:12px;
      color:#071021;
      background:var(--accent);
    }
    .pill.banned { background: linear-gradient(90deg,#ff7b7b,#ff4b4b); color:white }
    .pill.suspended { background: linear-gradient(90deg,#ffd79e,#f6c85f); color:#071021 }
    .pill.free { background:rgba(255,255,255,0.03); color:var(--muted) }

    .u-actions { display:flex; gap:8px; align-items:center }

    /* small helpers */
    .muted { color:var(--muted); font-size:13px }
    .note { font-size:12px; color:var(--muted); margin-top:8px }

    @media (max-width:980px){
      .shell{ grid-template-columns:1fr; }
      .card{ order:2 }
      .panel{ order:1 }
    }
  </style>
</head>
<body>
  <div class="shell" role="main" aria-label="User manager">
    <section class="card" aria-labelledby="consoleTitle">
      <h2 id="consoleTitle">Execution Console</h2>
      <p class="lead">Type one of: CREATE, BAN, IN, EDIT, SHOW, UN — use parentheses for arguments. Press Enter to run.</p>

      <div class="command-row" aria-hidden="false">
        <div class="cmd-input" role="group" aria-label="Command input">
          <svg width="18" height="18" viewBox="0 0 24 24" fill="none" style="opacity:.9">
            <path d="M4 7h16M4 12h16M4 17h16" stroke="rgba(255,255,255,0.85)" stroke-width="1.2" stroke-linecap="round" stroke-linejoin="round"/>
          </svg>
          <input id="cmd" class="cmd" placeholder="e.g. CREATE(John Doe,Active,2y,AUTO,true,3)" aria-label="Command input" />
        </div>
        <button id="run" class="btn" title="Run">RUN</button>
      </div>

      <div class="hint" aria-hidden="false">
        Syntax: CREATE(name,status,experience,id|AUTO,premium(true|false),trophies) • BAN(id) • IN(id) • UN(id) • EDIT(idOrIndex,field,newValue) • SHOW() or SHOW(id)
      </div>

      <div class="chips" aria-hidden="false">
        <button class="chip" data-cmd="CREATE(Alice,Active,3y,AUTO,true,5)">CREATE example</button>
        <button class="chip" data-cmd="BAN(0000000001)">BAN example</button>
        <button class="chip" data-cmd="IN(0000000001)">IN example</button>
        <button class="chip" data-cmd="UN(0000000001)">UN example</button>
        <button class="chip" data-cmd="EDIT(1,name,Jane)">EDIT example</button>
        <button class="chip" data-cmd="SHOW()">SHOW all</button>
      </div>

      <div id="log" class="log" role="log" aria-live="polite" aria-atomic="false"></div>
      <div class="note">Data is persisted in localStorage (key: <strong>bs_users</strong>).</div>
    </section>

    <aside class="panel" aria-labelledby="usersTitle">
      <h3 id="usersTitle">Users</h3>
      <p class="muted">Click any user to prefill a SHOW(id) command.</p>
      <div id="users" class="users" role="list"></div>
    </aside>
  </div>

  <script>
    // Storage key
    const STORAGE_KEY = 'bs_users';

    // Utilities
    function nowTime(){
      return new Date().toLocaleTimeString();
    }

    function log(msg, type='info') {
      const wrap = document.getElementById('log');
      const e = document.createElement('div');
      e.className = 'entry ' + (type === 'error' ? 'error' : 'info');
      const ts = document.createElement('div'); ts.className='ts'; ts.textContent = '['+ nowTime() +']';
      const body = document.createElement('div'); body.style.flex='1'; body.textContent = msg;
      e.appendChild(ts); e.appendChild(body);
      wrap.prepend(e);
    }

    function saveUsers(arr){
      localStorage.setItem(STORAGE_KEY, JSON.stringify(arr));
      renderUsers();
    }

    function loadUsers(){
      try{
        const raw = localStorage.getItem(STORAGE_KEY);
        if(!raw) return [];
        const parsed = JSON.parse(raw);
        return Array.isArray(parsed) ? parsed : [];
      } catch(e){
        console.error(e);
        return [];
      }
    }

    // Unique 10-digit id generator
    function generateId(existingSet){
      existingSet = existingSet || new Set(loadUsers().map(u=>String(u.id)));
      for(let i=0;i<1000;i++){
        const id = String(Math.floor(1e9 + Math.random()*9e9)); // 10-digit
        if(!existingSet.has(id)) return id;
      }
      // fallback incremental
      let id = String(Date.now()).slice(-10);
      while(existingSet.has(id)) {
        id = (parseInt(id,10)+1).toString().padStart(10,'0');
      }
      return id;
    }

    function normalizeStatus(s){
      if(!s) return 'Active';
      s = String(s).trim().toLowerCase();
      if(['active','a'].includes(s)) return 'Active';
      if(['banned','ban'].includes(s)) return 'Banned';
      if(['suspended','suspend','s'].includes(s)) return 'Suspended';
      return s.charAt(0).toUpperCase() + s.slice(1);
    }
    function parseBool(v){
      if(typeof v === 'boolean') return v;
      v = String(v).trim().toLowerCase();
      return ['true','1','yes','y'].includes(v);
    }

    // Render users in panel
    function renderUsers(){
      const container = document.getElementById('users');
      container.innerHTML = '';
      const users = loadUsers();
      if(users.length === 0){
        const p = document.createElement('div');
        p.className = 'muted';
        p.textContent = 'No users yet. Use CREATE(...) to add.';
        container.appendChild(p);
        return;
      }
      users.forEach((u, idx) => {
        const el = document.createElement('div'); el.className = 'user'; el.setAttribute('role','listitem');

        const av = document.createElement('div'); av.className='u-avatar'; av.textContent = (u.name && u.name[0]) ? u.name[0].toUpperCase() : '#';

        const body = document.createElement('div'); body.className='u-body';
        const nameRow = document.createElement('div'); nameRow.className='u-name';
        const nameEl = document.createElement('div'); nameEl.textContent = u.name || '—';
        const idEl = document.createElement('div'); idEl.className='u-id'; idEl.textContent = '#'+String(u.id);
        nameRow.appendChild(nameEl); nameRow.appendChild(idEl);

        const sub = document.createElement('div'); sub.className='u-sub';
        sub.textContent = `${u.experience || '-'} • ${u.trophies !== undefined ? u.trophies + ' trophies' : '-'}`;

        body.appendChild(nameRow); body.appendChild(sub);

        const meta = document.createElement('div'); meta.className='u-meta';
        const pill = document.createElement('div'); pill.className='pill';
        if(u.status === 'Banned'){ pill.className = 'pill banned'; pill.textContent='BANNED'; }
        else if(u.status === 'Suspended'){ pill.className = 'pill suspended'; pill.textContent='SUSPENDED'; }
        else { pill.className = 'pill'; pill.textContent = u.premium ? 'PREMIUM' : 'FREE'; }

        const actions = document.createElement('div'); actions.className='u-actions';
        const showBtn = document.createElement('button'); showBtn.className='chip'; showBtn.style.padding='6px 8px'; showBtn.style.fontSize='12px'; showBtn.textContent='SHOW';
        showBtn.addEventListener('click', (ev)=> { ev.stopPropagation(); runCommand(`SHOW(${u.id})`); });

        actions.appendChild(showBtn);
        meta.appendChild(pill);
        meta.appendChild(actions);

        el.appendChild(av);
        el.appendChild(body);
        el.appendChild(meta);

        // click to prefill command input
        el.addEventListener('click', ()=> {
          const c = document.getElementById('cmd');
          c.value = `SHOW(${u.id})`;
          c.focus();
        });

        container.appendChild(el);
      });
    }

    // Argument parser (handles quoted args)
    function parseArgs(text){
      if(!text) return [];
      const out = [];
      let cur = '';
      let quote = null;
      for(let i=0;i<text.length;i++){
        const ch = text[i];
        if((ch === '"' || ch === "'")){
          if(quote === ch){ quote = null; continue; }
          if(!quote){ quote = ch; continue; }
        }
        if(ch === ',' && !quote){
          out.push(cur.trim());
          cur = '';
          continue;
        }
        cur += ch;
      }
      if(cur.trim() !== '') out.push(cur.trim());
      return out.map(s => {
        if((s.startsWith('"') && s.endsWith('"')) || (s.startsWith("'") && s.endsWith("'"))){
          return s.slice(1,-1);
        }
        return s;
      });
    }

    // Commands
    function cmdCreate(args){
      if(args.length < 6){ log('CREATE requires 6 args: name,status,experience,id|AUTO,premium,trophies', 'error'); return; }
      const [name, statusRaw, exp, idRaw, premiumRaw, trophiesRaw] = args;
      const users = loadUsers();
      const existing = new Set(users.map(u=>String(u.id)));
      let id = String(idRaw).trim();
      if(!id || id.toUpperCase() === 'AUTO') id = generateId(existing);
      else {
        if(!/^\d{10}$/.test(id)){ log('ID must be exactly 10 digits or AUTO', 'error'); return; }
        if(existing.has(id)){ log('ID already exists', 'error'); return; }
      }
      const user = {
        name: String(name).trim(),
        status: normalizeStatus(statusRaw),
        experience: String(exp).trim(),
        id,
        premium: parseBool(premiumRaw),
        trophies: Number(trophiesRaw) || 0
      };
      users.push(user);
      saveUsers(users);
      log(`Created ${user.name} (${user.id})`);
    }

    function cmdBan(args){
      if(args.length < 1){ log('BAN requires id', 'error'); return; }
      const id = String(args[0]).trim();
      if(!/^\d{10}$/.test(id)){ log('ID must be 10 digits', 'error'); return; }
      const users = loadUsers();
      const u = users.find(x=>String(x.id)===id);
      if(!u){ log('User not found: '+id, 'error'); return; }
      u.status = 'Banned';
      saveUsers(users);
      log(`Banned ${u.name} (${id})`);
    }

    function cmdIn(args){
      if(args.length < 1){ log('IN requires id', 'error'); return; }
      const id = String(args[0]).trim();
      if(!/^\d{10}$/.test(id)){ log('ID must be 10 digits', 'error'); return; }
      const users = loadUsers();
      const u = users.find(x=>String(x.id)===id);
      if(!u){ log('User not found: '+id, 'error'); return; }
      u.status = 'Suspended';
      saveUsers(users);
      log(`Suspended ${u.name} (${id})`);
    }

    function cmdUn(args){
      if(args.length < 1){ log('UN requires id', 'error'); return; }
      const id = String(args[0]).trim();
      if(!/^\d{10}$/.test(id)){ log('ID must be 10 digits', 'error'); return; }
      const users = loadUsers();
      const u = users.find(x=>String(x.id)===id);
      if(!u){ log('User not found: '+id, 'error'); return; }
      u.status = 'Active';
      saveUsers(users);
      log(`Set Active: ${u.name} (${id})`);
    }

    function cmdEdit(args){
      if(args.length < 3){ log('EDIT requires: idOrIndex,field,newValue', 'error'); return; }
      const target = String(args[0]).trim();
      const field = String(args[1]).trim().toLowerCase();
      const newVal = args[2];

      const users = loadUsers();
      let idx = -1;
      if(/^\d{10}$/.test(target)){
        idx = users.findIndex(u => String(u.id) === target);
      } else if(/^\d+$/.test(target)){
        const n = parseInt(target,10);
        if(n>=1 && n<=users.length) idx = n-1;
      } else {
        idx = users.findIndex(u => u.name === target);
      }

      if(idx === -1){ log('EDIT: user not found for ' + target, 'error'); return; }
      const user = users[idx];

      switch(field){
        case 'name': user.name = String(newVal).trim(); break;
        case 'status': user.status = normalizeStatus(newVal); break;
        case 'experience': user.experience = String(newVal).trim(); break;
        case 'id':
          const nid = String(newVal).trim();
          if(!/^\d{10}$/.test(nid)){ log('New id must be 10 digits', 'error'); return; }
          if(users.some((u,i)=>i!==idx && String(u.id)===nid)){ log('ID already in use', 'error'); return; }
          user.id = nid;
          break;
        case 'premium': user.premium = parseBool(newVal); break;
        case 'trophies':
          const t = Number(newVal);
          if(Number.isNaN(t)){ log('trophies must be a number', 'error'); return; }
          user.trophies = t;
          break;
        default:
          log('Unknown field: ' + field, 'error'); return;
      }
      saveUsers(users);
      log(`Edited ${user.name} (${user.id}) — set ${field} = ${newVal}`);
    }

    function cmdShow(args){
      const users = loadUsers();
      if(args.length === 0 || !args[0]){
        if(users.length === 0){ log('No users to show', 'error'); return; }
        log(`SHOW: ${users.length} users`);
        // display compact
        users.slice().reverse().forEach(u => {
          log(formatUser(u));
        });
        return;
      }
      const q = String(args[0]).trim();
      let user = null;
      if(/^\d{10}$/.test(q)){
        user = users.find(u=>String(u.id)===q);
      } else if(/^\d+$/.test(q)){
        const n = parseInt(q,10);
        if(n>=1 && n<=users.length) user = users[n-1];
      } else {
        user = users.find(u=>u.name === q);
      }

      if(!user){ log('User not found: '+q, 'error'); return; }
      log('SHOW: single');
      log(formatUser(user));
    }

    function formatUser(u){
      return `${u.name} • id:${u.id} • ${u.status} • exp:${u.experience || '-'} • premium:${u.premium} • trophies:${u.trophies}`;
    }

    // Command dispatcher
    function runCommand(raw){
      if(!raw || !raw.trim()){ log('No command provided', 'error'); return; }
      const m = raw.trim().match(/^([A-Za-z_]+)\s*(?:\((.*)\))?$/);
      if(!m){ log('Invalid command format', 'error'); return; }
      const cmd = m[1].toUpperCase();
      const args = parseArgs(m[2] || '');
      try{
        switch(cmd){
          case 'CREATE': cmdCreate(args); break;
          case 'BAN': cmdBan(args); break;
          case 'IN': cmdIn(args); break;
          case 'UN': cmdUn(args); break;
          case 'EDIT': cmdEdit(args); break;
          case 'SHOW': cmdShow(args); break;
          default: log('Unknown command: ' + cmd, 'error');
        }
      } catch(e){
        console.error(e);
        log('Error: ' + e.message, 'error');
      }
    }

    
